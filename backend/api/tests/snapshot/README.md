# スナップショットテスト

このディレクトリには、ゴールデンデータを使用したスナップショットテストが含まれています。

## 概要

スナップショットテストは、APIのレスポンスが期待通りの形式・内容であることを保証するためのテストです。
このプロジェクトでは、Parquet形式でゴールデンデータを保存し、実際のAPIレスポンスと比較します。

## ゴールデンデータの作成方法

1. サーバーを起動します
```bash
python manage.py runserver
```

2. テストデータを作成します
```python
# setup_golden_data fixtureで作成されるデータと同じものを手動で作成
```

3. ゴールデンデータを収集します（実装例）
```bash
# スクリプトを実行してAPIレスポンスをParquet形式で保存
python api/tests/scripts/collect_golden_data.py
```

## テストの実行

```bash
# スナップショットテストのみ実行
pytest -m snapshot

# スナップショットテストをスキップ
pytest --ignore=api/tests/snapshot
```

## メリット

1. **リグレッション検出**: APIの変更による意図しない影響を即座に検出
2. **効率的なデータ保存**: Parquet形式により大量のテストデータを圧縮保存
3. **完全一致検証**: 実データとの完全一致を検証可能

## 注意点

このサンプルリポジトリでは、概念を示すためにテストコードのみを含めています。
実際のゴールデンデータ（`.parquet`ファイル）は省略されています。

本番環境では、以下の手順でゴールデンデータを作成してください：
1. テストデータをセットアップ
2. 期待通りのAPIレスポンスを確認
3. `snapshot_comparator.create_snapshot()`を使用してゴールデンデータを保存
